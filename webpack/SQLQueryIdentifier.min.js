!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("SQLQueryIdentifier",[],e):"object"==typeof exports?exports.SQLQueryIdentifier=e():t.SQLQueryIdentifier=e()}(self,(function(){return(()=>{"use strict";var t={468:(t,e,n)=>{n.r(e),n.d(e,{identify:()=>N});var r=["SELECT","INSERT","DELETE","UPDATE","CREATE","DROP","TABLE","TRIGGER","FUNCTION","DATABASE","TRUNCATE"],o={";":"semicolon"};function i(t){var e=a(t);if(c(e))return function(t){var e;do{e=a(t)}while(c(e));null===e||c(e)||u(t);var n=t.input.slice(t.start,t.position+1);return{type:"whitespace",value:n,start:t.start,end:t.start+n.length-1}}(t);if(function(t,e){var n="-"===t;if(!n)return!1;var r=a(e);(n="-"===r)||u(e);return n}(e,t))return function(t){var e;do{e=a(t)}while("\n"!==e&&null!==e);null!==e&&"\n"!==e&&u(t);var n=t.input.slice(t.start,t.position+1);return{type:"comment-inline",value:n,start:t.start,end:t.start+n.length-1}}(t);if(function(t,e){var n="/"===t;if(!n)return!1;var r=a(e);(n="*"===r)||u(e);return n}(e,t))return function(t){var e,n;do{n=e,e=a(t)}while(n+e!=="*/"&&null!==e);null!==e&&"/"!==e&&u(t);var r=t.input.slice(t.start,t.position+1);return{type:"comment-block",value:r,start:t.start,end:t.start+r.length-1}}(t);if(function(t){return"'"===t}(e))return function(t){var e;do{e=a(t)}while("'"!==e&&null!==e);null!==e&&"'"!==e&&u(t);var n=t.input.slice(t.start,t.position+1);return{type:"string",value:n,start:t.start,end:t.start+n.length-1}}(t);if(function(t){return t.input.slice(t.start).match(/^\$[\w]*\$/)}(t))return function(t){for(var e,n=t.input.slice(t.start).match(/^(\$[a-zA-Z0-9_]*\$)/)[1],r=0;r<n.length-1;r++)a(t);for(;t.input.slice(t.position,t.position+n.length)!==n&&null!==e;){do{e=a(t)}while("$"!==e&&null!==e);"$"!==e&&null!==e&&u(t)}for(var o=0;o<n.length-1;o++)a(t);var i=t.input.slice(t.start,t.position+1);return{type:"string",value:i,start:t.start,end:t.start+i.length-1}}(t);if(s(e))return function(t){var e;do{e=a(t)}while(s(e));null===e||s(e)||u(t);var n=t.input.slice(t.start,t.position+1);if(o=n,!r.includes(o.toUpperCase()))return function(t,e){return{type:"unknown",value:e,start:t.start,end:t.start+e.length-1}}(t,n);var o;return{type:"keyword",value:n,start:t.start,end:t.start+n.length-1}}(t);var n=function(t){var e=t.input.slice(t.start,t.position+1),n=function(t){return o[t]}(e);if(!n)return null;return{type:n,value:e,start:t.start,end:t.start+e.length-1}}(t);return n||function(t){return{type:"unknown",value:t.input.slice(t.start,t.position+1),start:t.start,end:t.start}}(t)}function a(t){return t.position===t.input.length-1?null:(t.position++,t.input[t.position])}function u(t){t.position!==t.start&&t.position--}function c(t){return" "===t||"\t"===t||"\n"===t}function s(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"||"_"===t}var p={SELECT:"LISTING",INSERT:"MODIFICATION",DELETE:"MODIFICATION",UPDATE:"MODIFICATION",CREATE_DATABASE:"MODIFICATION",CREATE_TABLE:"MODIFICATION",CREATE_TRIGGER:"MODIFICATION",CREATE_FUNCTION:"MODIFICATION",DROP_DATABASE:"MODIFICATION",DROP_TABLE:"MODIFICATION",DROP_TRIGGER:"MODIFICATION",DROP_FUNCTION:"MODIFICATION",TRUNCATE:"MODIFICATION",UNKNOWN:"UNKNOWN"},l=["CREATE_TRIGGER","CREATE_FUNCTION"],d={generic:["BEGIN","CASE"],psql:["BEGIN","CASE","LOOP","IF"],mysql:["BEGIN","CASE","LOOP","IF"],mssql:["BEGIN","CASE"],sqlite:["BEGIN","CASE"]};function f(t){for(var e,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"generic",o=v({input:t}),a={type:"QUERY",start:0,end:t.length-1,body:[],tokens:[]},u=o,c=["whitespace","comment-inline","comment-block"];u.position<o.end;){var s=v({prevState:u}),p=i(s);if(!e){if(c.includes(p.type)){a.tokens.push(p),u=s;continue}e=T(p,{isStrict:n,dialect:r})}e.addToken(p),a.tokens.push(p),u=s;var l=e.getStatement();l.endStatement&&(l.end=p.end,a.body.push(l),e=null)}if(e){var d=e.getStatement();d.endStatement||(d.end=a.end,a.body.push(d))}return a}function v(t){var e=t.input,n=t.prevState;return n?{input:n.input,position:n.position,start:n.position+1,end:n.input.length-1,body:[]}:{input:e,position:-1,start:0,end:e.length-1,body:[]}}function T(t,e){if("keyword"===t.type)switch(t.value.toUpperCase()){case"SELECT":return n=e.isStrict,o=[{preCanGoToNext:function(){return!1},validation:{acceptTokens:[{type:"keyword",value:"SELECT"}]},add:function(t){r.type="SELECT",r.start=t.start},postCanGoToNext:function(){return!0}}],y(r={},o,{isStrict:n});case"CREATE":return function(t){var e=t.isStrict,n=t.dialect,r={},o=[{preCanGoToNext:function(){return!1},validation:{acceptTokens:[{type:"keyword",value:"CREATE"}]},add:function(t){r.start=t.start},postCanGoToNext:function(){return!0}},{preCanGoToNext:function(){return!1},validation:{requireBefore:["whitespace"],acceptTokens:[{type:"keyword",value:"TABLE"},{type:"keyword",value:"DATABASE"},{type:"keyword",value:"TRIGGER"},{type:"keyword",value:"FUNCTION"}]},add:function(t){r.type="CREATE_".concat(t.value.toUpperCase())},postCanGoToNext:function(){return!0}}];return y(r,o,{isStrict:e,dialect:n})}(e);case"DROP":return function(t){var e=t.isStrict,n={},r=[{preCanGoToNext:function(){return!1},validation:{acceptTokens:[{type:"keyword",value:"DROP"}]},add:function(t){n.start=t.start},postCanGoToNext:function(){return!0}},{preCanGoToNext:function(){return!1},validation:{requireBefore:["whitespace"],acceptTokens:[{type:"keyword",value:"TABLE"},{type:"keyword",value:"DATABASE"},{type:"keyword",value:"TRIGGER"},{type:"keyword",value:"FUNCTION"}]},add:function(t){n.type="DROP_".concat(t.value.toUpperCase())},postCanGoToNext:function(){return!0}}];return y(n,r,{isStrict:e})}(e);case"INSERT":return function(t){var e=t.isStrict,n={},r=[{preCanGoToNext:function(){return!1},validation:{acceptTokens:[{type:"keyword",value:"INSERT"}]},add:function(t){n.type="INSERT",n.start=t.start},postCanGoToNext:function(){return!0}}];return y(n,r,{isStrict:e})}(e);case"UPDATE":return function(t){var e=t.isStrict,n={},r=[{preCanGoToNext:function(){return!1},validation:{acceptTokens:[{type:"keyword",value:"UPDATE"}]},add:function(t){n.type="UPDATE",n.start=t.start},postCanGoToNext:function(){return!0}}];return y(n,r,{isStrict:e})}(e);case"DELETE":return function(t){var e=t.isStrict,n={},r=[{preCanGoToNext:function(){return!1},validation:{acceptTokens:[{type:"keyword",value:"DELETE"}]},add:function(t){n.type="DELETE",n.start=t.start},postCanGoToNext:function(){return!0}}];return y(n,r,{isStrict:e})}(e);case"TRUNCATE":return function(t){var e=t.isStrict,n={},r=[{preCanGoToNext:function(){return!1},validation:{acceptTokens:[{type:"keyword",value:"TRUNCATE"}]},add:function(t){n.type="TRUNCATE",n.start=t.start},postCanGoToNext:function(){return!0}}];return y(n,r,{isStrict:e})}(e)}var n,r,o;if(!e.isStrict&&"unknown"===t.type)return function(t){var e=t.isStrict,n={},r=[{preCanGoToNext:function(){return!1},add:function(t){n.type="UNKNOWN",n.start=t.start},postCanGoToNext:function(){return!0}}];return y(n,r,{isStrict:e})}(e.isStrict);throw new Error('Invalid statement parser "'.concat(t.value,'"'))}function y(t,e,n){var r,o,i=n.isStrict,a=n.dialect,u=void 0===a?"generic":a,c=0,s=0,f=function(t){o=r,r=t};return{getStatement:function(){return t},addToken:function(n){if(t.endStatement)throw new Error("This statement has already got to the end.");if("semicolon"!==n.type||l.includes(t.type)&&(0!==s||!t.canEnd)){if("END"===n.value.toUpperCase())return 0===--s&&(t.canEnd=!0),void f(n);if("whitespace"!==n.type){if("psql"!==u||!["OR","REPLACE"].includes(n.value.toUpperCase())){if("keyword"===n.type&&d[u].includes(n.value)&&"END"!==o.value)return s++,void f(n);if("mysql"===u&&"DEFINER"===n.value.toUpperCase())return t.definer=0,void f(n);if(0===t.definer&&"="===n.value)return t.definer++,void f(n);if(t.definer>0){if(1===t.definer&&"whitespace"===r.type)return t.definer++,void f(n);if(t.definer>1&&"whitespace"!==r.type)return void f(n);t.definer=!1}if(!t.type){var a,v=e[c];if(v.preCanGoToNext(n)&&(c++,v=e[c]),(a=v).requireBefore&&!a.requireBefore.includes(r.type)){var T=v.requireBefore.join(" or ");throw new Error("Expected any of these tokens ".concat(T,' before "').concat(n.value,'" (currentStep=').concat(c,")."))}if(!function(t,e){return!t.validation||t.validation.acceptTokens.filter((function(t){var n=e.type===t.type,r=!t.value||e.value.toUpperCase()===t.value;return n&&r})).length>0}(v,n)&&i){var y=v.validation.acceptTokens.map((function(t){return'(type="'.concat(t.type,'" value="').concat(t.value,'")')})).join(" or ");throw new Error("Expected any of these tokens ".concat(y,' instead of type="').concat(n.type,'" value="').concat(n.value,'" (currentStep=').concat(c,")."))}v.add(n),t.executionType=p[t.type]||"UNKNOWN",v.postCanGoToNext(n)&&c++,f(n)}}}else f(n)}else t.endStatement=";"}}}var E=["mssql","sqlite","mysql","psql","generic"];function N(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=void 0===e.strict||e.strict,r=void 0===e.dialect?"generic":e.dialect;if(!E.includes(r))throw new Error("Unknown dialect. Allowed values: ".concat(E.join(",")));var o=f(t,n,r);return o.body.map((function(e){return{start:e.start,end:e.end,text:t.substring(e.start,e.end+1),type:e.type,executionType:e.executionType}}))}}},e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}return n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n(468)})()}));
//# sourceMappingURL=SQLQueryIdentifier.min.js.map